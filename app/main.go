package main

import (
	"app/controller/api"
	"app/controller/crawler"
	"app/controller/log"
	"app/controller/postgres"

	_ "github.com/lib/pq"
)

func main() {
	// =======================================================================
	// データベース接続とテーブル初期化
	// =======================================================================
	err := postgres.Connect()
	if err != nil {
		return
	}
	err = postgres.InitTable()
	if err != nil {
		return
	}

	// =======================================================================
	// クローリングの開始
	// =======================================================================
	log.Info("クローリングの開始")
	crawler.Start()

	// =======================================================================
	// API サーバーを起動
	// =======================================================================
	log.Info("API の初期化")
	api.StartServer()
}
