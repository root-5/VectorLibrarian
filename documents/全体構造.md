# プロジェクト全体構造

## 1. 概要

このプロジェクトは、指定されたWebサイトをドメイン単位で解析・ベクトル化して、自然言語でのベクトル検索機能を提供することを目的としています。

## 2. 主要コンポーネント

システムは、以下の3つの主要なDockerコンテナ化されたサービスで構成されています。
これらのサービスは `docker-compose` を用いて連携して動作します。

- **`app` (Go)**: バックエンドサービス
- **`nlp` (Python)**: 自然言語処理 (NLP) サービス
- **`db` (PostgreSQL)**: データベース

### 2.1. `app` (Go)

- **言語**: Go
- **役割**:
  - WebページのクロールとHTMLコンテンツの取得
  - 取得したHTMLのパースとテキスト抽出
  - 外部にベクトル検索用APIを提供
  - `db` サービスへのデータ永続化を依頼 (ページ情報など)
  - `nlp` サービスと連携し、テキストのベクトル化を依頼
- **主要ライブラリ**:
  - `html-to-markdown`: HTMLをMarkdownに変換
  - `colly`: Webスクレイピング

### 2.2. `nlp` (Python)

- **言語**: Python
- **役割**:
  - `app` サービスから受け取ったテキストデータをベクトル化
- **主要ライブラリ**:
  - `FastAPI`: APIサーバーの構築
  - `neologdn`: テキスト正規化
  - `sentence_transformers`: 文のベクトル化

### 2.3. `db` (PostgreSQL)

- **データベース**: PostgreSQL
- **役割**:
  - クロールしたWebページの情報と対応するベクトルデータなどの保存
- **拡張機能**:
  - `pgvector`: ベクトルデータの保存と効率的な類似度検索を可能にするPostgreSQLの拡張機能
- **主要テーブル**:
  - `pages`: クロールしたページの情報

## 3. アーキテクチャ図 (テキストベース)

```text
+-----------------+      +-----------------+      +-----------------+
|      User       |----->|   app (Go)      |<---->|   db (Postgres) |
+-----------------+      |  - Crawler      |      |   - pgvector    |
                         |  - API Server   |      |   - Semantic    |
                         +-------+---------+      |     Search      |
                                 |                +-----------------+
                                 v
                         +-------+---------+
                         |  nlp (Python)   |
                         |  - Vectorize    |
                         |  - Semantic     |
                         |    Search       |
                         +-----------------+
```

## 4. ディレクトリ構造

- **/app**: バックエンドサービスコンテナのソースコードとDockerfile
- **/nlp**: 自然言語処理サービスコンテナのソースコードとDockerfile
- **/db**: データベースサービスコンテナのソースコードとDockerfile
- **/documents**: プロジェクト関連のドキュメント
- **compose.yml**: 開発環境用のDocker Composeファイルです。
- **compose.prod.yml**: 本番環境用のDocker Composeファイルです。
